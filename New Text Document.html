<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Jetson Surveillance Dashboard & Weekly Behavior Log</title>
<style>
  body {
    margin: 0; padding: 20px;
    background: #0f0f0f; color: #eee;
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
  }
  header {
    text-align: center; font-size: 2rem; font-weight: 700;
    margin-bottom: 1rem; color: #00b3ff;
  }
  .grid {
    display: grid;
    grid-template-columns: repeat(auto-fit,minmax(320px,1fr));
    gap: 20px;
    margin-bottom: 40px;
  }
  .card {
    background: #1c1c1c;
    border-radius: 10px;
    padding: 1rem;
    box-shadow: 0 0 15px #007bb8aa;
  }
  video {
    width: 100%;
    height: 200px;
    border-radius: 8px;
    background: #000;
    object-fit: cover;
  }
  ul {
    list-style: none; padding: 0;
  }
  ul li {
    padding: 0.3rem 0;
    border-bottom: 1px dashed #333;
  }
  #aiLogContainer {
    max-height: 220px;
    overflow-y: auto;
    background: #222;
    padding: 0.5rem;
    border-radius: 8px;
    font-family: monospace;
    font-size: 0.9rem;
  }
  .log-entry {
    padding: 0.25rem 0;
    border-bottom: 1px solid #333;
  }
  button.btn {
    margin-top: 0.8rem;
    background: #00b3ff;
    border: none;
    color: #000;
    font-weight: 600;
    padding: 0.5rem 1rem;
    border-radius: 6px;
    cursor: pointer;
    width: 100%;
  }
  button.btn:hover {
    background: #009ad1;
    color: #fff;
  }
  #filters {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    justify-content: center;
    max-width: 960px;
    margin: 0 auto 1rem;
  }
  #filters label {
    user-select: none;
    font-weight: 600;
    cursor: pointer;
  }
  #filters input[type=checkbox] {
    margin-right: 0.4rem;
    transform: scale(1.2);
    vertical-align: middle;
    cursor: pointer;
  }
  #logContainer {
    max-width: 960px;
    margin: 0 auto 2rem;
    background: #222;
    border-radius: 8px;
    padding: 1rem;
    height: 460px;
    overflow-y: auto;
    white-space: pre-wrap;
    font-family: monospace;
    font-size: 0.9rem;
  }
  h1 {
    text-align: center;
    color: #00b3ff;
    margin-bottom: 0.5rem;
  }
  .export-section {
    max-width: 960px;
    margin: 2rem auto;
    background: #1c1c1c;
    border-radius: 10px;
    padding: 1.25rem;
    box-shadow: 0 0 15px #007bb8aa;
  }
  .export-section h2 {
    color: #00b3ff;
    margin: 0 0 1rem 0;
    font-size: 1.25rem;
  }
  .export-categories {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 0.75rem;
    margin-bottom: 1rem;
  }
  .export-categories label {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    cursor: pointer;
    user-select: none;
    padding: 0.4rem 0;
  }
  .export-categories input[type=checkbox] {
    margin: 0;
    transform: scale(1.2);
    cursor: pointer;
  }
  .sort-row {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1rem;
  }
  .sort-row label {
    font-weight: 600;
  }
  .sort-row select {
    background: #222;
    color: #eee;
    border: 1px solid #00b3ff;
    border-radius: 6px;
    padding: 0.4rem 0.8rem;
    font-size: 0.9rem;
    cursor: pointer;
  }
  .export-actions {
    display: flex;
    flex-wrap: wrap;
    gap: 0.75rem;
  }
  .export-actions .btn {
    margin-top: 0;
    width: auto;
  }
</style>
</head>
<body>

<header>üõ∞Ô∏è Jetson AGX Orin Surveillance Dashboard</header>

<div class="grid">
  <div class="card">
    <h3>Thermal Feed (FLIR FX34)</h3>
    <video autoplay loop muted playsinline>
      <source src="https://media.w3.org/2010/05/sintel/trailer.mp4" type="video/mp4" />
      Your browser does not support the video tag.
    </video>
  </div>
  <div class="card">
    <h3>PTZ Dome (Axis 4K)</h3>
    <video autoplay loop muted playsinline>
      <source src="https://www.w3schools.com/html/movie.mp4" type="video/mp4" />
    </video>
  </div>
  <div class="card">
    <h3>Low-Light Sony Alpha 7S III</h3>
    <video autoplay loop muted playsinline>
      <source src="https://www.w3schools.com/html/mov_bbb.mp4" type="video/mp4" />
    </video>
  </div>
</div>

<div class="grid">
  <div class="card">
    <h3>System Status</h3>
    <ul>
      <li><strong>Battery:</strong> 13.6V (92%)</li>
      <li><strong>Solar Input:</strong> 310W</li>
      <li><strong>NVMe Storage:</strong> 9.2TB Free</li>
      <li><strong>LTE Signal:</strong> -70 dBm</li>
      <li><strong>Uptime:</strong> 5 days, 4 hrs</li>
    </ul>
  </div>
  <div class="card">
    <h3>AI Detection Log</h3>
    <div id="aiLogContainer" aria-live="polite" aria-label="AI detection log">
      <div class="log-entry">[07:02:18] üö® Person Detected ‚Äì East Gate (FLIR)</div>
      <div class="log-entry">[06:47:12] üïµÔ∏è Suspicious Vehicle ‚Äì Black SUV (Plate: Q9X-456)</div>
      <div class="log-entry">[06:12:30] üêæ Animal Detected ‚Äì Bobcat, South Field</div>
      <div class="log-entry">[05:39:55] üîí Intrusion Alert ‚Äì West Fence Breach</div>
      <div class="log-entry">[04:55:22] üéØ Unknown Movement Pattern ‚Äì Prolonged Loitering</div>
    </div>
    <button class="btn" onclick="exportAILogs()">üì§ Export AI Detection Log (.txt)</button>
  </div>
  <div class="card">
    <h3>Controls</h3>
    <button class="btn" onclick="triggerDevice('Siren')">üîä Activate Siren</button>
    <button class="btn" onclick="triggerDevice('Floodlights')">üí° Toggle Floodlights</button>
    <button class="btn" onclick="triggerDevice('Lockdown')">üîí Activate Lockdown</button>
  </div>
</div>

<h1>Weekly Surveillance Behavior Log</h1>
<div id="filters" role="region" aria-label="Filter log categories"></div>
<div id="logContainer" aria-live="polite" aria-label="Surveillance behavior logs"></div>
<div style="max-width: 960px; margin: 0 auto;">
  <button class="btn" id="exportBtn" aria-label="Export filtered surveillance logs">Export Logs</button>
</div>

<section class="export-section" aria-label="Export and data">
  <h2>üì¶ Export &amp; Data</h2>
  <p style="margin: 0 0 1rem 0; color: #aaa;">Download AI data, verify integrity, recordings, map and analytics. Select categories and sort order below.</p>
  <div class="export-categories" role="group" aria-label="Data categories to export">
    <label><input type="checkbox" id="exp-ai" checked /> ü§ñ AI data</label>
    <label><input type="checkbox" id="exp-integrity" checked /> ‚úÖ Verify integrity</label>
    <label><input type="checkbox" id="exp-recordings" checked /> üé¨ Recordings</label>
    <label><input type="checkbox" id="exp-map" checked /> üó∫Ô∏è Map</label>
    <label><input type="checkbox" id="exp-analytics" checked /> üìä Analytics</label>
  </div>
  <div class="sort-row">
    <label for="exportSort">Sort by:</label>
    <select id="exportSort" aria-label="Sort export data by">
      <option value="date-desc">Date (newest first)</option>
      <option value="date-asc">Date (oldest first)</option>
      <option value="category">Category</option>
      <option value="type">Type</option>
    </select>
  </div>
  <div class="export-actions">
    <button class="btn" id="downloadExportBtn" aria-label="Download selected data">üì• Download selected</button>
    <button class="btn" id="verifyIntegrityBtn" aria-label="Verify data integrity">üîê Verify integrity</button>
  </div>
</section>

<script>
  function triggerDevice(device) {
    alert(device + ' command sent (simulated).');
  }

  function exportAILogs() {
    const entries = document.querySelectorAll('#aiLogContainer .log-entry');
    let text = '';
    entries.forEach(e => text += e.textContent + '\n');
    const blob = new Blob([text], {type:'text/plain'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'ai_detection_log.txt';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
  }

  const surveillanceCategories = [
    { icon: 'üö∏', name: 'Emotional & Behavioral Red Flags', id: 'emotional' },
    { icon: 'üö∑', name: 'Risky Activities or Suspicious Behavior', id: 'risky' },
    { icon: 'üßç‚Äç‚ôÄÔ∏èüßç‚Äç‚ôÇÔ∏è', name: 'Social Interactions at the Property', id: 'social' },
    { icon: 'üß≥', name: 'Physical Object Indicators', id: 'physical' },
    { icon: 'üöò', name: 'Vehicle-Related Surveillance Risks', id: 'vehicle' },
    { icon: 'üåô', name: 'Time- and Pattern-Based Red Flags', id: 'time' },
    { icon: 'üîä', name: 'Audio/Environmental Triggers', id: 'audio' },
    { icon: 'üîí', name: 'Security Breaches or Safety Threats', id: 'security' }
  ];

  const cameras = [
    { name: 'FLIR FX34 Thermal', location: 'Front Yard' },
    { name: 'Axis PTZ Dome 4K', location: 'Garage' },
    { name: 'Sony Alpha 7S III', location: 'Driveway' },
    { name: 'Backyard Infrared Cam', location: 'Backyard' },
    { name: 'Garage Interior Cam', location: 'Garage' },
    { name: 'Porch Wide-Angle Cam', location: 'Porch' }
  ];

  const sampleIssues = {
    emotional: ['Running out of the house crying','Pacing on driveway nervously','Sitting alone quietly','Slamming doors angrily'],
    risky: ['Scaling fence at night','Using window to enter','Unfamiliar vehicle pickup','Burying objects near porch'],
    social: ['Unfamiliar male visitor','Hugging/kissing in driveway','Meeting visitors at odd hours','Peers pressuring near garage'],
    physical: ['Carrying large bag','Leaving with backpack','Returning with suspicious package','Discarding items on lawn'],
    vehicle: ['Repeated circling vehicle','Unknown car parked long','Multiple cars arriving late','Vehicle revving loudly'],
    time: ['Frequent visits at midnight','Loitering past curfew','Weekend night gatherings','Unusual daytime absences'],
    audio: ['Loud shouting','Glass breaking','Car alarms','Dog barking continuously'],
    security: ['Fence tampering','Door left open','Window broken','Alarm triggered']
  };

  function randomChoice(arr) {
    return arr[Math.floor(Math.random() * arr.length)];
  }
  function randomDateWithinLastWeek() {
    const now = new Date();
    const past = new Date(now.getTime() - 7*24*3600*1000);
    return new Date(past.getTime() + Math.random()*(now.getTime() - past.getTime()));
  }

  const logs = [];
  for(let i=0; i<150; i++) {
    const cat = randomChoice(surveillanceCategories);
    const issue = randomChoice(sampleIssues[cat.id]);
    const cam = randomChoice(cameras);
    const date = randomDateWithinLastWeek();
    const dateStr = date.toISOString().slice(0,10);
    const timeStr = date.toTimeString().slice(0,8);
    logs.push({
      category: cat.id,
      categoryName: `${cat.icon} ${cat.name}`,
      issue,
      camera: cam.name,
      location: cam.location,
      date: dateStr,
      timestamp: timeStr,
      details: `Observed by ${cam.name} at ${cam.location} on ${dateStr} at ${timeStr}.`
    });
  }

  const filtersDiv = document.getElementById('filters');
  surveillanceCategories.forEach(cat => {
    const label = document.createElement('label');
    label.innerHTML = `<input type="checkbox" id="${cat.id}" checked /> ${cat.icon} ${cat.name}`;
    filtersDiv.appendChild(label);
  });

  const logContainer = document.getElementById('logContainer');

  function getSortCompare() {
    const sortBy = (document.getElementById('exportSort') || {}).value || 'date-desc';
    return (a, b) => {
      switch (sortBy) {
        case 'date-asc':
          return new Date(a.date + ' ' + a.timestamp) - new Date(b.date + ' ' + b.timestamp);
        case 'category':
          return (a.categoryName || '').localeCompare(b.categoryName || '');
        case 'type':
          return (a.category || '').localeCompare(b.category || '');
        default:
          return new Date(b.date + ' ' + b.timestamp) - new Date(a.date + ' ' + a.timestamp);
      }
    };
  }

  function renderLogs() {
    const selectedCats = surveillanceCategories.filter(cat => document.getElementById(cat.id).checked).map(cat => cat.id);
    const filtered = logs.filter(log => selectedCats.includes(log.category)).sort(getSortCompare());

    if(filtered.length === 0) {
      logContainer.textContent = 'No logs for selected categories.';
      return;
    }

    logContainer.textContent = filtered.map(log => {
      return `üóìÔ∏è ${log.date} @ ${log.timestamp}\nCategory: ${log.categoryName}\nIssue: ${log.issue}\nCamera: ${log.camera} (${log.location})\nDetails: ${log.details}\n--------------------------------------------`;
    }).join('\n\n');
  }

  renderLogs();

  filtersDiv.querySelectorAll('input[type=checkbox]').forEach(cb => {
    cb.addEventListener('change', renderLogs);
  });

  const exportSortEl = document.getElementById('exportSort');
  if (exportSortEl) exportSortEl.addEventListener('change', renderLogs);

  document.getElementById('exportBtn').addEventListener('click', () => {
    const selectedCats = surveillanceCategories.filter(cat => document.getElementById(cat.id).checked).map(cat => cat.id);
    const filteredLogs = logs.filter(log => selectedCats.includes(log.category)).sort(getSortCompare());
    if(filteredLogs.length === 0) {
      alert('No logs to export for selected categories.');
      return;
    }
    let output = `Weekly Surveillance Behavior Log Export\nGenerated on ${new Date().toLocaleString()}\n\n`;
    filteredLogs.forEach(log => {
      output += `Date: ${log.date} @ ${log.timestamp}\nCategory: ${log.categoryName}\nIssue: ${log.issue}\nCamera: ${log.camera}\nLocation: ${log.location}\nDetails: ${log.details}\n--------------------------------------------\n`;
    });

    const blob = new Blob([output], {type:'text/plain'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = `weekly_behavior_log_${new Date().toISOString().slice(0,10)}.txt`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
  });

  function getExportSelected() {
    return {
      ai: document.getElementById('exp-ai')?.checked ?? true,
      integrity: document.getElementById('exp-integrity')?.checked ?? true,
      recordings: document.getElementById('exp-recordings')?.checked ?? true,
      map: document.getElementById('exp-map')?.checked ?? true,
      analytics: document.getElementById('exp-analytics')?.checked ?? true
    };
  }

  document.getElementById('downloadExportBtn').addEventListener('click', () => {
    const sel = getExportSelected();
    const parts = [];
    const sortCompare = getSortCompare();
    if (sel.ai) {
      const aiEntries = document.querySelectorAll('#aiLogContainer .log-entry');
      let aiText = 'AI Detection Log\n' + new Date().toISOString() + '\n\n';
      aiEntries.forEach(e => { aiText += e.textContent + '\n'; });
      parts.push({ name: 'ai_data', content: aiText });
    }
    if (sel.integrity) {
      parts.push({ name: 'integrity_checksum', content: 'SHA-256 (simulated): ' + Array.from({ length: 64 }, () => Math.floor(Math.random() * 16).toString(16)).join('') + '\nGenerated: ' + new Date().toISOString() + '\n' });
    }
    if (sel.recordings) {
      parts.push({ name: 'recordings_index', content: 'Recordings index (simulated)\nLast 7 days: 24 clips\nFormat: AVI, H.264\nGenerated: ' + new Date().toISOString() + '\n' });
    }
    if (sel.map) {
      parts.push({ name: 'map_waypoints', content: 'Map/waypoints export (simulated)\nCameras: 6\nEvents: ' + logs.length + '\nGenerated: ' + new Date().toISOString() + '\n' });
    }
    if (sel.analytics) {
      const selectedCats = surveillanceCategories.filter(cat => document.getElementById(cat.id).checked).map(cat => cat.id);
      const filtered = logs.filter(log => selectedCats.includes(log.category)).sort(sortCompare);
      let analyticsText = 'Analytics export\nGenerated: ' + new Date().toISOString() + '\n\n';
      analyticsText += filtered.map(log => `${log.date} ${log.timestamp} | ${log.category} | ${log.issue}`).join('\n');
      parts.push({ name: 'analytics', content: analyticsText });
    }
    if (parts.length === 0) {
      alert('Select at least one category under Export & Data.');
      return;
    }
    const combined = parts.map(p => '=== ' + p.name.toUpperCase() + ' ===\n' + p.content).join('\n\n');
    const blob = new Blob([combined], { type: 'text/plain' });
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'export_data_' + new Date().toISOString().slice(0, 10) + '.txt';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(a.href);
  });

  document.getElementById('verifyIntegrityBtn').addEventListener('click', () => {
    const sel = getExportSelected();
    const checks = [];
    if (sel.ai) checks.push('AI data');
    if (sel.integrity) checks.push('Integrity hashes');
    if (sel.recordings) checks.push('Recordings index');
    if (sel.map) checks.push('Map data');
    if (sel.analytics) checks.push('Analytics');
    if (checks.length === 0) {
      alert('Select at least one category to verify.');
      return;
    }
    alert('Integrity verification (simulated)\n\nChecked: ' + checks.join(', ') + '\nResult: OK ‚Äì no tampering detected.');
  });
</script>

</body>
</html>
